#!/bin/sh

#export OPENHRPHOME=@OPENHRP_DIR@
export OPENHRPHOME=/home/kanehiro/openhrp3.0
export GRXUI_TEMP=/tmp/.grxui
export JAVAVM=java
export JYTHON_HOME=@JYTHON_HOME@
export JMFHOME=$CLASSPATH:@OPENHRP_SHARE_DIR@/java/JMF2.1.1e
export J3DHOME=$CLASSPATH:@OPENHRP_SHARE_DIR@/java/Java3D
export TMPFS_DIR=
export GRXUI_TEMP=/tmp/.grxui
export NS_HOST=localhost
export NS_PORT=2809
export NS_OPT="-ORBInitRef NameService=corbaloc:iiop:${NS_HOST}:${NS_PORT}/NameService"
export NAMESERV="omniNames -start ${NS_PORT} -logdir ${GRXUI_TEMP}"

export CLASSPATH=$CLASSPATH:@OPENHRP_SHARE_DIR@/java/grxui.jar:@OPENHRP_SHARE_DIR@/java/openhrpstubskel.jar:@JYTHON_JAR@:@OPENHRP_SHARE_DIR@/java/vrml97.jar:$HRP_STUB_PATH

export EXTRA_JAVA_FLAGS=-Djava.ext.dirs=$JMFHOME/unix/lib:$J3DHOME/1.4.1/unix/lib/ext:$J3DHOME/1.4.1/unix/lib/i386:$JYTHON_HOME

if [ ! -d ${GRXUI_TEMP} ]; then
    mkdir ${GRXUI_TEMP}
fi

##
# GrxUI usage:
#
#   ./GrxUI.sh "" "" "" on
#   ./GrxUI.sh project/HRP2 OpenHRP3 script/test.py off
##
DEFAULT_PROJECT=$1
DEFAULT_MODE=$2
SCRIPT=$3
DEBUG=$4

## 
# for client/gui/grxuirc.xml
##
BIN_DIR=$OPENHRPHOME/bin
BIN_SFX=.sh

if [ -f ${GRXUI_TEMP}/omninames-*.log ] ; then
	/bin/rm ${GRXUI_TEMP}/omninames-*.*;
fi

cd @OPENHRP_SHARE_DIR@/java/grxui

$JAVAVM -server -Xmx512m \
	$EXTRA_JAVA_FLAGS  \
	-DPROJECT="$DEFAULT_PROJECT" \
	-DMODE="$DEFAULT_MODE" \
	-DSCRIPT="$SCRIPT" \
	-DDEBUG=$DEBUG \
	-DNS_OPT="$NS_OPT" \
	-DOPENHRPHOME=$OPENHRPHOME \
	-DBIN_DIR=$BIN_DIR \
	-DBIN_SFX=$BIN_SFX \
	-Dpython.home=$JYTHON_HOME \
	-Dpython.path=$JYTHON_JAR:$JYTHON_HOME/Lib:$JYTHON_HOME/Lib-cpython \
	-Dpython.cachedir=$HOME/.jython-cache \
	com.generalrobotix.ui.GrxUI

##
# NOTE:
#   to startup GrxUI from eclipse 
#   set argument -D??? : OPENHRPHOME , BIN_DIR , BIN_SFX
##
